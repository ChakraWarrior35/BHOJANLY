{% extends 'base.html' %}
{% load static %}

{% block title %}Checkout - Bhojanly{% endblock title %}

{% block body %}
<style>
	.checkout-container { background: #181818; padding: 24px; border-radius: 10px; color: #fff; }
	.payment-option { margin: 12px 0; }
	.card-fields, .upi-field { margin-left: 18px; margin-top: 8px; }
	input[type="text"], input[type="number"] { padding: 8px; border-radius:4px; border:1px solid #444; background:#222; color:#fff; }
	button.pay { background:#ff6f3c; color:#fff; border:none; padding:10px 16px; border-radius:6px; cursor:pointer; }
</style>

<div class="container mt-5 checkout-container">
	<h2>Checkout</h2>
	{% if cart_items %}
		<p><strong>Total:</strong> â‚¹{{ total }}</p>
		<form method="post" action="{% url 'buy' %}">
			{% csrf_token %}
			<div class="payment-option">
				<label><input type="radio" name="payment_method" value="upi" checked> UPI</label>
				<div class="upi-field" id="upi-field">
					<input type="text" name="upi_id" placeholder="Enter UPI ID (example@bank)">
				</div>
			</div>

			<div class="payment-option">
				<label><input type="radio" name="payment_method" value="credit_card"> Credit Card</label>
				<div class="card-fields" id="card-fields-cc" style="display:none;">
					<input type="text" name="cc_number" placeholder="Card Number"><br><br>
					<input type="text" name="cc_name" placeholder="Name on card"><br><br>
					<input type="text" name="cc_exp" placeholder="MM/YY"> <input type="number" name="cc_cvv" placeholder="CVV" style="width:100px;">
				</div>
			</div>

			<div class="payment-option">
				<label><input type="radio" name="payment_method" value="debit_card"> Debit Card</label>
				<div class="card-fields" id="card-fields-dc" style="display:none;">
					<input type="text" name="dc_number" placeholder="Card Number"><br><br>
					<input type="text" name="dc_name" placeholder="Name on card"><br><br>
					<input type="text" name="dc_exp" placeholder="MM/YY"> <input type="number" name="dc_cvv" placeholder="CVV" style="width:100px;">
				</div>
			</div>

			<div class="payment-option">
				<label><input type="radio" name="payment_method" value="cod"> Cash on Delivery</label>
			</div>

			<button type="submit" class="pay">Pay / Place Order</button>
		</form>
	{% else %}
		<p>Your cart is empty.</p>
	{% endif %}
</div>

<script>
	function showHideFields() {
		const method = document.querySelector('input[name="payment_method"]:checked').value;
		document.getElementById('upi-field').style.display = method === 'upi' ? 'block' : 'none';
		document.getElementById('card-fields-cc').style.display = method === 'credit_card' ? 'block' : 'none';
		document.getElementById('card-fields-dc').style.display = method === 'debit_card' ? 'block' : 'none';
	}
	document.querySelectorAll('input[name="payment_method"]').forEach(r => r.addEventListener('change', showHideFields));
	document.addEventListener('DOMContentLoaded', showHideFields);
</script>

{% endblock body %}